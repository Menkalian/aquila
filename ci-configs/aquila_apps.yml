appsBuild:
  stage: application-build
  image: mingc/android-build-box:1.20.0
  script:
    - cd aquila-app
    - chmod +x ./gradlew
    - ./gradlew assemble
  artifacts:
    paths:
      - aquila-app/.gradle
      - aquila-app/build
      - aquila-app/*/build
    expire_in: 1 week

appsTest:
  stage: application-test
  image: mingc/android-build-box:1.20.0
  script:
    - cd aquila-app
    - chmod +x ./gradlew
    - ./gradlew test

appsPublish:
  stage: application-deploy
  image: mingc/android-build-box:1.20.0
  only:
    - main
  script:
    - cd aquila-app
    - chmod +x ./gradlew
    - ./gradlew publish
  artifacts:
    paths:
      - aquila-app/*/build/outputs/apk/debug/*.apk
      - aquila-app/*/build/outputs/apk/release/*.apk
    expire_in: 1 month